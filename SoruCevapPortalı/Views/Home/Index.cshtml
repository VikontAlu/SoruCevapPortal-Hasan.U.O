@{
    ViewData["Title"] = "Ana Sayfa";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var recentQuestions = ViewBag.RecentQuestions as List<SoruCevapPortalı.Models.Question>;
    var categories = ViewBag.Categories as List<SoruCevapPortalı.Models.Category>;
}

<div class="bg-primary bg-gradient text-white py-5 mb-5 rounded-3 position-relative overflow-hidden shadow-sm">
    <div class="container position-relative z-index-1 text-center">
        <h1 class="display-4 fw-bold">Bilgi Paylaştıkça Çoğalır</h1>
        <p class="lead mb-4 opacity-75">Merak ettiklerini sor, bildiklerini paylaş ve topluluğa katıl.</p>

        @if (!User.Identity.IsAuthenticated)
        {
            <div class="d-flex justify-content-center gap-3">
                <a href="/Identity/Account/Register" class="btn btn-light btn-lg fw-bold px-4 text-primary">Hemen Katıl</a>
                <a href="/Question/Index" class="btn btn-outline-light btn-lg px-4">Keşfet</a>
            </div>
        }
        else
        {
            <a href="/Question/Ask" class="btn btn-light btn-lg fw-bold px-5 text-primary shadow-lg">
                <i class="fas fa-plus-circle me-2"></i>Soru Sor
            </a>
        }
    </div>
    <i class="fas fa-comments position-absolute top-50 start-0 translate-middle-y ms-n5 text-white opacity-10" style="font-size: 15rem;"></i>
    <i class="fas fa-question position-absolute bottom-0 end-0 mb-n5 me-n5 text-white opacity-10" style="font-size: 15rem;"></i>
</div>

<div class="container">

    <div class="row g-4">

        <div class="col-lg-8">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h4 class="fw-bold text-dark mb-0"><i class="fas fa-fire text-warning me-2"></i>Son Eklenenler</h4>
                <a href="/Question/Index" class="btn btn-sm btn-outline-secondary">Tümünü Gör</a>
            </div>

            @if (recentQuestions != null && recentQuestions.Any())
            {
                <div class="d-flex flex-column gap-3">
                    @foreach (var q in recentQuestions)
                    {
                        <div class="card border-0 shadow-sm p-3 hover-effect">
                            <div class="d-flex">
                                <div class="d-flex flex-column align-items-center justify-content-center me-3 p-2 rounded bg-light border" style="min-width: 60px;">
                                    <span class="fw-bold fs-5 @(q.Answers.Count > 0 ? "text-success" : "text-muted")">@q.Answers.Count</span>
                                    <small class="text-muted" style="font-size: 10px;">Cevap</small>
                                </div>

                                <div class="flex-grow-1">
                                    <h5 class="mb-1">
                                        <a href="/Question/Details/@q.Id" class="text-decoration-none text-primary fw-bold stretched-link">
                                            @q.Title
                                        </a>
                                    </h5>
                                    <p class="text-muted small mb-2 text-truncate" style="max-width: 500px;">
                                        @q.Content
                                    </p>
                                    <div class="d-flex justify-content-between align-items-center small text-muted">
                                        <span>
                                            <i class="fas fa-folder text-warning me-1"></i> @q.Category?.Name
                                        </span>
                                        <span>
                                            <i class="far fa-clock me-1"></i> @q.CreatedDate.ToString("dd.MM.yyyy")
                                            <span class="mx-1">•</span>
                                            <i class="far fa-user me-1"></i> @q.ApplicationUser?.UserName
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            }
            else
            {
                <div class="alert alert-light text-center border">Henüz soru eklenmemiş.</div>
            }
        </div>

        <div class="col-lg-4">
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-white fw-bold py-3 border-bottom-0">
                    <i class="fas fa-folder-open text-primary me-2"></i>Popüler Kategoriler
                </div>
                <div class="list-group list-group-flush">
                    @if (categories != null)
                    {
                        foreach (var c in categories)
                        {
                            <a href="/Question/ByCategory/@c.Id" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center border-0 px-3 py-2">
                                <span><i class="fas fa-angle-right text-muted me-2"></i>@c.Name</span>
                                <span class="badge bg-light text-dark border rounded-pill">@(c.Questions?.Count ?? 0)</span>
                            </a>
                        }
                    }
                </div>
            </div>

            <div class="card bg-info bg-opacity-10 border-0 p-3 shadow-sm">
                <h5 class="fw-bold text-dark"><i class="fas fa-lightbulb text-warning me-2"></i>Biliyor muydunuz?</h5>
                <p class="small text-muted mb-0">En iyi cevabı seçerek hem soruyu kapatabilir hem de cevaplayan kişiye puan kazandırabilirsiniz!</p>
            </div>
        </div>
    </div>
</div>

<style>
    .hover-effect {
        transition: background-color 0.2s;
    }

        .hover-effect:hover {
            background-color: #f8f9fa;
        }
</style>